# LearnFoundry

## 测试覆盖率

File | % Lines | % Statements | % Branches | % Funcs |
+=============================================================================================+
| script/ModelMarket.s.sol | 0.00% (0/5) | 0.00% (0/3) | 100.00% (0/0) | 0.00% (0/2) |
|--------------------------+----------------+----------------+---------------+----------------|
| src/ModelMarket.sol | 96.23% (51/53) | 96.30% (52/54) | 14.29% (4/28) | 100.00% (9/9) |
|--------------------------+----------------+----------------+---------------+----------------|
| test/ModelMarket.t.sol | 100.00% (2/2) | 100.00% (1/1) | 100.00% (0/0) | 100.00% (1/1) |
|--------------------------+----------------+----------------+---------------+----------------|
| Total | 88.33% (53/60) | 91.38% (53/58) | 14.29% (4/28) | 83.33% (10/12)

运行覆盖率的正确命令
`forge coverage --match-contract ModelMarketTest --ir-minimum`

## 合约拆分

把 ModelMarket 合约拆分为以下模块：

1. ModelStructs.sol
   定义了所有数据结构和枚举
   使用库形式，便于其他合约导入使用
2. AdminControl.sol
   管理员相关功能
   包括佣金比例设置、佣金接收地址设置和管理员权限转移
3. ModelManagement.sol
   继承 AdminControl
   处理模型的注册、下架、查询等基本操作
   包含名称和 IPFS 哈希的唯一性检验
4. ModelAccess.sol
   继承 ModelManagement
   处理模型的购买、访问控制等功能
   包含佣金分配的逻辑
5. ReportManagement.sol
   继承 ModelAccess
   处理模型评测报告的添加和查询
6. ModelMarket.sol
   主合约，继承 ReportManagement
   整合所有其他模块的功能
